/* stylelint-disable at-rule-no-unknown, property-no-unknown, selector-pseudo-class-no-unknown */
/* eslint-disable */
/* 
  This file uses Tailwind CSS directives (@tailwind, @apply, @layer) 
  which are not recognized by standard CSS linters but are valid in a Tailwind CSS context.
*/
@import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css");

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Christian-themed Design System for Jonah's Journey */

@layer base {
  :root {
    /* Modern Korean UI color palette */
    --background: 0 0% 98%;
    --foreground: 220 9% 20%;

    --card: 0 0% 100%;
    --card-foreground: 220 9% 20%;

    --popover: 0 0% 100%;
    --popover-foreground: 220 9% 20%;

    /* Primary - Warm Blue */
    --primary: 210 100% 50%;
    --primary-foreground: 0 0% 100%;
    --primary-glow: 210 100% 65%;

    /* Secondary - Soft Gray */
    --secondary: 210 10% 95%;
    --secondary-foreground: 220 9% 20%;

    /* Spiritual colors - Refined */
    --divine: 210 100% 50%;
    --divine-foreground: 0 0% 100%;
    --heaven: 210 40% 96%;
    --heaven-foreground: 220 9% 20%;
    --ocean: 200 85% 45%;
    --ocean-light: 200 60% 80%;
    --storm: 220 30% 25%;
    --whale: 220 15% 35%;

    /* Status colors */
    --muted: 210 15% 96%;
    --muted-foreground: 215 16% 50%;
    --accent: 210 40% 96%;
    --accent-foreground: 220 9% 20%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;

    /* Borders and inputs */
    --border: 220 13% 91%;
    --input: 0 0% 100%;
    --ring: 210 100% 50%;

    /* Modern gradients */
    --gradient-divine: linear-gradient(
      135deg,
      hsl(var(--primary)),
      hsl(var(--primary-glow))
    );
    --gradient-heaven: linear-gradient(
      180deg,
      hsl(var(--heaven)),
      hsl(var(--secondary))
    );
    --gradient-ocean: linear-gradient(
      180deg,
      hsl(var(--ocean-light)),
      hsl(var(--ocean))
    );
    --gradient-storm: linear-gradient(
      45deg,
      hsl(var(--storm)),
      hsl(220 25% 30%)
    );

    /* Refined shadows */
    --shadow-soft: 0 4px 20px -4px hsl(var(--foreground) / 0.1);
    --shadow-medium: 0 8px 30px -8px hsl(var(--foreground) / 0.15);
    --shadow-large: 0 20px 40px -10px hsl(var(--foreground) / 0.2);

    /* Animation timings */
    --transition-divine: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

    --radius: 0.75rem;

    --sidebar-background: 0 0% 98%;

    --sidebar-foreground: 240 5.3% 26.1%;

    --sidebar-primary: 240 5.9% 10%;

    --sidebar-primary-foreground: 0 0% 98%;

    --sidebar-accent: 240 4.8% 95.9%;

    --sidebar-accent-foreground: 240 5.9% 10%;

    --sidebar-border: 220 13% 91%;

    --sidebar-ring: 217.2 91.2% 59.8%;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;

    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;

    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;

    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;

    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;

    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;

    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    @apply text-base sm:text-lg;
    @apply font-normal leading-relaxed sm:leading-loose;
    font-family: "Pretendard", "Apple SD Gothic Neo", "Noto Sans KR",
      "Malgun Gothic", sans-serif;
  }

  /* Mobile-optimized typography */
  @media (max-width: 640px) {
    body {
      @apply text-base leading-7; /* 16px with better line height for mobile */
    }
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: "Pretendard", sans-serif;
    @apply font-semibold leading-tight;
  }

  /* Mobile-first heading sizes */
  h1 {
    @apply text-xl sm:text-2xl md:text-3xl;
  }

  h2 {
    @apply text-lg sm:text-xl md:text-2xl;
  }

  h3 {
    @apply text-base sm:text-lg md:text-xl;
  }

  /* Improved paragraph spacing for mobile */
  p {
    @apply mb-4 leading-7 sm:leading-8;
  }
}

@layer components {
  /* Mobile-optimized input styles */
  .scripture-input {
    @apply w-full text-base sm:text-lg;
    @apply p-4 sm:p-6;
    @apply bg-input border border-border rounded-xl;
    @apply focus:border-primary focus:ring-2 focus:ring-primary/20;
    @apply shadow-sm;
    min-height: 48px;
    font-family: "Pretendard", sans-serif;
  }

  @media (min-width: 640px) {
    .scripture-input {
      min-height: 56px;
    }
  }

  .verse-text {
    @apply p-4 sm:p-6;
    @apply bg-card rounded-xl border border-border shadow-sm;
    @apply text-base sm:text-lg text-foreground;
    @apply leading-7 sm:leading-8;
    background: linear-gradient(135deg, hsl(var(--card)), hsl(var(--accent)));
    border-left: 4px solid hsl(var(--primary));
  }

  /* Chapter backgrounds */
  .chapter-bg-1 {
    /* Clear blue sky gradient */
    background: linear-gradient(
      180deg,
      hsl(204 100% 88%) 0%,
      /* sky top */ hsl(204 92% 86%) 30%,
      hsl(201 90% 84%) 60%,
      hsl(201 86% 82%) 100%
    );
  }

  .chapter-bg-2 {
    background: var(--gradient-heaven);
  }

  .chapter-bg-3 {
    background: var(--gradient-storm);
  }

  .chapter-bg-4,
  .chapter-bg-5,
  .chapter-bg-6 {
    background: var(--gradient-heaven);
  }

  /* Mobile-optimized button variants */
  .btn-divine {
    @apply px-6 py-4 sm:px-8 sm:py-5;
    @apply rounded-xl font-medium text-primary-foreground;
    @apply text-base sm:text-lg;
    min-height: 48px;
    background: hsl(var(--primary));
    box-shadow: var(--shadow-soft);
    font-family: "Pretendard", sans-serif;
  }

  @media (min-width: 640px) {
    .btn-divine {
      min-height: 56px;
    }
  }

  .btn-divine:hover {
    background: hsl(var(--primary) / 0.9);
  }

  .btn-ocean {
    @apply px-6 py-4 sm:px-8 sm:py-5;
    @apply rounded-xl font-medium text-white;
    @apply text-base sm:text-lg;
    min-height: 48px;
    background: linear-gradient(
      135deg,
      hsl(var(--ocean)),
      hsl(var(--ocean-light))
    );
    box-shadow: var(--shadow-soft);
    font-family: "Pretendard", sans-serif;
  }

  @media (min-width: 640px) {
    .btn-ocean {
      min-height: 56px;
    }
  }
}

@layer utilities {
  .font-pretendard {
    font-family: "Pretendard", sans-serif;
  }

  .text-divine {
    color: hsl(var(--divine));
  }

  .text-heaven {
    color: hsl(var(--heaven-foreground));
  }

  .text-ocean {
    color: hsl(var(--ocean));
  }

  .bg-divine {
    background-color: hsl(var(--divine));
  }

  .bg-heaven {
    background-color: hsl(var(--heaven));
  }

  .bg-ocean {
    background-color: hsl(var(--ocean));
  }

  /* Chapter-specific animations */
  .harbor-crowd {
    animation: float 3s ease-in-out infinite;
  }

  .rain {
    animation: rain-fall 2s linear infinite;
  }

  /* Dense shower for stormy chapter: many slanted streaks */
  .shower-layer {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
  }

  .shower {
    position: absolute;
    width: 2px;
    height: 18vh;
    background: linear-gradient(
      to bottom,
      hsl(var(--ocean-light) / 0),
      hsl(var(--ocean-light) / 0.7)
    );
    transform: rotate(15deg);
    animation: shower-fall 1.2s linear infinite;
    will-change: transform, opacity;
  }

  .shower.slower {
    animation-duration: 1.6s;
    opacity: 0.6;
  }
  .shower.faster {
    animation-duration: 0.9s;
    opacity: 0.8;
  }

  @keyframes shower-fall {
    0% {
      transform: translate(-10vw, -30vh) rotate(15deg);
      opacity: 0.2;
    }
    10% {
      opacity: 0.8;
    }
    100% {
      transform: translate(10vw, 110vh) rotate(15deg);
      opacity: 0.2;
    }
  }

  .stormy-sea {
    animation: wave 2s ease-in-out infinite;
  }

  .whale-appear {
    animation: whale-rise 4s ease-in-out infinite;
  }

  /* New, more dramatic ocean animation for Chapter 3 */
  .wave-layer {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 38vh; /* tall enough to cover bottom with parallax */
    pointer-events: none;
    overflow: hidden;
  }

  .wave-content {
    position: absolute;
    left: -10%;
    width: 120%; /* allow horizontal sway without exposing edges */
    bottom: 0;
    height: 100%;
  }

  .wave-sway-slow {
    animation: wave-sway 8s ease-in-out infinite;
  }
  .wave-sway {
    animation: wave-sway 6s ease-in-out infinite;
  }
  .wave-sway-fast {
    animation: wave-sway 4.2s ease-in-out infinite;
  }

  /* Actors (boat/whale) follow the same sway as waves for perfect sync */
  .actor-sway-slow {
    animation: wave-sway 8s ease-in-out infinite;
    will-change: transform;
  }
  .actor-sway {
    animation: wave-sway 6s ease-in-out infinite;
    will-change: transform;
  }
  .actor-sway-fast {
    animation: wave-sway 4.2s ease-in-out infinite;
    will-change: transform;
  }

  /* Rougher wave motion: larger horizontal sway and vertical heave */
  @keyframes wave-sway {
    0% {
      transform: translateX(-6%) translateY(0);
    }
    20% {
      transform: translateX(4%) translateY(-10px);
    }
    40% {
      transform: translateX(6%) translateY(-2px);
    }
    60% {
      transform: translateX(-3%) translateY(8px);
    }
    80% {
      transform: translateX(-5%) translateY(2px);
    }
    100% {
      transform: translateX(-6%) translateY(0);
    }
  }

  /* Whale horizontal drift + vertical bobbing, without background shape */
  .whale-drift-x {
    animation: whale-drift 10s ease-in-out infinite;
    will-change: transform;
  }

  /* Constrained drift ranges to keep whale/boat apart horizontally */
  .whale-drift-left {
    animation: whale-drift-left 11s ease-in-out infinite;
    will-change: transform;
  }

  .whale-drift-right {
    animation: whale-drift-right 11s ease-in-out infinite;
    will-change: transform;
  }

  .whale-bob {
    display: inline-block;
    animation: whale-bob 3.6s ease-in-out infinite;
  }

  @keyframes whale-drift {
    0% {
      transform: translateX(-45%);
    }
    50% {
      transform: translateX(45%);
    }
    100% {
      transform: translateX(-45%);
    }
  }

  @keyframes whale-drift-left {
    0% {
      transform: translateX(-10%);
    }
    50% {
      transform: translateX(20%);
    }
    100% {
      transform: translateX(-10%);
    }
  }

  @keyframes whale-drift-right {
    0% {
      transform: translateX(-20%);
    }
    50% {
      transform: translateX(10%);
    }
    100% {
      transform: translateX(-20%);
    }
  }

  @keyframes whale-bob {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-8px);
    }
  }

  /* Boat floating on top wave */
  .boat-drift-x {
    animation: boat-drift 9s ease-in-out infinite;
    will-change: transform;
  }

  .boat-drift-right {
    animation: boat-drift-right 10s ease-in-out infinite;
    will-change: transform;
  }

  .boat-drift-left {
    animation: boat-drift-left 10s ease-in-out infinite;
    will-change: transform;
  }

  .boat-bob {
    display: inline-block;
    animation: boat-bob 2.8s ease-in-out infinite;
  }

  .boat-tilt {
    display: inline-block;
    animation: boat-tilt 3.6s ease-in-out infinite;
  }

  @keyframes boat-drift {
    0% {
      transform: translateX(-35%);
    }
    50% {
      transform: translateX(35%);
    }
    100% {
      transform: translateX(-35%);
    }
  }

  @keyframes boat-drift-right {
    0% {
      transform: translateX(-15%);
    }
    50% {
      transform: translateX(10%);
    }
    100% {
      transform: translateX(-15%);
    }
  }

  @keyframes boat-drift-left {
    0% {
      transform: translateX(-10%);
    }
    50% {
      transform: translateX(15%);
    }
    100% {
      transform: translateX(-10%);
    }
  }

  @keyframes boat-bob {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-6px);
    }
  }

  @keyframes boat-tilt {
    0%,
    100% {
      transform: rotate(-2deg);
    }
    50% {
      transform: rotate(3deg);
    }
  }

  /* Utility: horizontal flip wrapper so it composes with tilt/bob */
  .flip-x {
    display: inline-block;
    transform: scaleX(-1);
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  @keyframes rain-fall {
    0% {
      transform: translateY(-100vh);
      opacity: 0;
    }
    10% {
      opacity: 1;
    }
    90% {
      opacity: 1;
    }
    100% {
      transform: translateY(100vh);
      opacity: 0;
    }
  }

  @keyframes wave {
    0%,
    100% {
      transform: scale(1) translateY(0);
    }
    50% {
      transform: scale(1.1) translateY(-5px);
    }
  }

  @keyframes whale-rise {
    0%,
    100% {
      transform: translateX(-50%) translateY(20px);
      opacity: 0.7;
    }
    50% {
      transform: translateX(-50%) translateY(-10px);
      opacity: 1;
    }
  }

  .divine-glow {
    filter: drop-shadow(0 0 20px hsl(var(--divine) / 0.3));
  }

  /* ===== Chapter 1 Scenic Elements ===== */
  .sun {
    position: absolute;
    top: 6vh;
    right: 8vw;
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: radial-gradient(
      circle at 30% 30%,
      #fff8d6 0%,
      #ffe88a 50%,
      #ffd04d 70%,
      #ffb703 100%
    );
    box-shadow: 0 0 60px 20px rgba(255, 215, 80, 0.35),
      0 0 100px 40px rgba(255, 215, 80, 0.2);
    animation: sun-glow 6s ease-in-out infinite;
  }

  @keyframes sun-glow {
    0%,
    100% {
      transform: translateY(0);
      filter: drop-shadow(0 0 12px rgba(255, 200, 60, 0.5));
    }
    50% {
      transform: translateY(-6px);
      filter: drop-shadow(0 0 18px rgba(255, 200, 60, 0.7));
    }
  }

  .cloud-layer {
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  .cloud {
    position: absolute;
    width: 160px;
    height: 60px;
    background: #fff;
    border-radius: 50px;
    box-shadow: 30px 10px 0 8px #fff, 65px -8px 0 6px #fff,
      100px 6px 0 10px #fff;
    opacity: 0.9;
    filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.06));
  }
  .cloud-sm {
    transform: scale(0.8);
    opacity: 0.8;
  }
  .cloud-md {
    transform: scale(1);
  }
  .cloud-lg {
    transform: scale(1.2);
  }

  .cloud-drift-slow {
    animation: cloud-drift 42s linear infinite;
  }
  .cloud-drift {
    animation: cloud-drift 30s linear infinite;
  }
  .cloud-drift-fast {
    animation: cloud-drift 22s linear infinite;
  }

  @keyframes cloud-drift {
    0% {
      transform: translateX(-30vw) translateZ(0) scale(var(--c-scale, 1));
    }
    100% {
      transform: translateX(130vw) translateZ(0) scale(var(--c-scale, 1));
    }
  }

  /* Rolling hills and grass field */
  .field {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 40vh;
    pointer-events: none;
  }

  .hill {
    position: absolute;
    bottom: 10vh;
    width: 60vw;
    height: 30vh;
    border-radius: 50% 50% 0 0;
    background: radial-gradient(
      circle at 50% 10%,
      #7bc96f 0%,
      #5bbd57 60%,
      #46a74a 100%
    );
    filter: blur(0.5px) saturate(1.05);
  }
  .hill-left {
    left: -10vw;
    transform: rotate(-2deg);
  }
  .hill-right {
    right: -8vw;
    transform: rotate(3deg);
    background: radial-gradient(
      circle at 50% 10%,
      #86d47a 0%,
      #64c662 60%,
      #49ae4e 100%
    );
  }

  .grass {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 22vh;
    background: linear-gradient(180deg, #6dcf5e 0%, #4fb94b 40%, #3d9f3d 100%);
    box-shadow: 0 -8px 20px rgba(0, 0, 0, 0.06) inset;
  }

  /* ===== Fortress Wall (Nineveh) for Chapter 4 ===== */
  .fortress-layer {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: clamp(120px, 18vh, 220px);
    pointer-events: none;
    z-index: 10; /* above scenic ground but below content */
  }

  .fortress-battlements {
    position: absolute;
    left: 0;
    right: 0;
    bottom: calc(100% - 14px);
    height: 28px;
    display: flex;
    gap: 10px;
    justify-content: center;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.12));
  }

  .fortress-merlon {
    display: inline-block;
    width: clamp(14px, 3vw, 22px);
    height: 100%;
    background: linear-gradient(180deg, #d7c8a3 0%, #c7b78c 100%);
    border: 1px solid rgba(110, 95, 60, 0.25);
    border-bottom: none;
    border-radius: 2px 2px 0 0;
  }

  .fortress-body {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 100%;
    background: linear-gradient(180deg, #d9caa6 0%, #c9b98f 60%, #b3a072 100%);
    border-top: 2px solid rgba(110, 95, 60, 0.4);
    box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1) inset,
      0 -20px 40px rgba(0, 0, 0, 0.06) inset;
    clip-path: polygon(0 6%, 100% 6%, 100% 100%, 0 100%);
  }

  .fortress-texture {
    position: absolute;
    inset: 0;
    background-image: linear-gradient(
        90deg,
        rgba(120, 100, 60, 0.08) 1px,
        rgba(0, 0, 0, 0) 1px
      ),
      linear-gradient(
        180deg,
        rgba(120, 100, 60, 0.06) 1px,
        rgba(0, 0, 0, 0) 1px
      );
    background-size: 22px 100%, 100% 16px;
    opacity: 0.7;
  }

  /* Sheep animation */
  .sheep-layer {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 36vh;
    pointer-events: none;
  }
  .sheep-runner {
    position: absolute;
    left: -10vw;
    animation-name: sheep-run;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    will-change: transform;
  }
  .sheep-scale {
    display: inline-block;
  }
  .sheep-wander {
    display: inline-block;
    animation-name: sheep-wander;
    animation-timing-function: ease-in-out;
    animation-iteration-count: infinite;
    animation-direction: alternate;
  }
  .sheep-flip-y {
    display: inline-block;
    transform: scaleX(-1);
  }
  .sheep-bob {
    display: inline-block;
    font-size: clamp(28px, 6vw, 64px);
    animation: sheep-bob 0.9s ease-in-out infinite;
  }

  @keyframes sheep-bob {
    0%,
    100% {
      transform: translateY(0) rotate(-2deg);
    }
    50% {
      transform: translateY(-6px) rotate(2deg);
    }
  }

  @keyframes sheep-run {
    0% {
      transform: translateX(-12vw);
    }
    100% {
      transform: translateX(112vw);
    }
  }

  @keyframes sheep-wander {
    0% {
      transform: translate(0, 0) rotate(-1deg);
    }
    50% {
      transform: translate(var(--wander-x, 6px), var(--wander-y, -4px))
        rotate(1deg);
    }
    100% {
      transform: translate(
          calc(var(--wander-x, 6px) * -0.6),
          calc(var(--wander-y, -4px) * -0.6)
        )
        rotate(-1.2deg);
    }
  }

  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    .cloud-drift-slow,
    .cloud-drift,
    .cloud-drift-fast,
    .sun,
    .sheep-bob,
    .sheep-runner,
    .sheep-wander {
      animation: none !important;
    }
  }

  /* Sun rays and lens flare */
  .flare-group {
    position: absolute;
    top: 0;
    right: 0;
    width: 40vw;
    height: 40vh;
    pointer-events: none;
    overflow: visible;
  }
  .flare {
    position: absolute;
    background: radial-gradient(
      circle,
      rgba(255, 255, 255, 0.8),
      rgba(255, 255, 255, 0) 70%
    );
    border-radius: 9999px;
    mix-blend-mode: screen;
    filter: blur(2px);
    opacity: 0.35;
    animation: flare-pulse 6s ease-in-out infinite;
  }
  .flare-1 {
    width: 140px;
    height: 140px;
    top: 6vh;
    right: 8vw;
    animation-delay: 0s;
  }
  .flare-2 {
    width: 90px;
    height: 90px;
    top: 16vh;
    right: 18vw;
    animation-delay: 0.6s;
  }
  .flare-3 {
    width: 60px;
    height: 60px;
    top: 22vh;
    right: 26vw;
    animation-delay: 1.2s;
  }
  .flare-4 {
    width: 40px;
    height: 40px;
    top: 28vh;
    right: 34vw;
    animation-delay: 1.8s;
  }

  @keyframes flare-pulse {
    0%,
    100% {
      opacity: 0.25;
      transform: scale(0.95);
    }
    50% {
      opacity: 0.55;
      transform: scale(1.05);
    }
  }

  /* Sun rays: subtle radial beams */
  .sun::before,
  .sun::after {
    content: "";
    position: absolute;
    inset: -40%;
    border-radius: 50%;
    background: conic-gradient(
      from 0deg,
      rgba(255, 215, 80, 0) 0deg,
      rgba(255, 215, 80, 0.22) 20deg,
      rgba(255, 215, 80, 0) 40deg,
      rgba(255, 215, 80, 0.18) 60deg,
      rgba(255, 215, 80, 0) 80deg,
      rgba(255, 215, 80, 0.16) 100deg,
      rgba(255, 215, 80, 0) 120deg,
      rgba(255, 215, 80, 0.14) 140deg,
      rgba(255, 215, 80, 0) 160deg,
      rgba(255, 215, 80, 0.12) 180deg,
      rgba(255, 215, 80, 0) 200deg,
      rgba(255, 215, 80, 0.1) 220deg,
      rgba(255, 215, 80, 0) 240deg,
      rgba(255, 215, 80, 0.08) 260deg,
      rgba(255, 215, 80, 0) 280deg,
      rgba(255, 215, 80, 0.06) 300deg,
      rgba(255, 215, 80, 0) 320deg,
      rgba(255, 215, 80, 0.04) 340deg,
      rgba(255, 215, 80, 0) 360deg
    );
    filter: blur(8px);
    mix-blend-mode: screen;
    opacity: 0.4;
  }
  .sun::before {
    animation: rays-rotate 24s linear infinite;
  }
  .sun::after {
    animation: rays-rotate 36s linear infinite reverse;
  }
  @keyframes rays-rotate {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
}

/* ===== Chapter 2 Harbor + Seagulls ===== */
@layer utilities {
  .harbor-layer {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0; /* fixed at bottom; do not move entire harbor */
    height: 40vh; /* occupies bottom area below sky */
    pointer-events: none;
    z-index: 1;
    /* Pier positioning variables */
    --pier-bottom: 22vh;
    --pier-height: 22px;
  }

  .harbor-water {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 22vh;
    background: linear-gradient(
      180deg,
      hsl(var(--ocean-light)) 0%,
      hsl(var(--ocean)) 100%
    );
    box-shadow: 0 -8px 20px rgba(0, 0, 0, 0.06) inset;
    opacity: 0.95;
  }

  .wave-cap {
    position: absolute;
    width: 48px;
    height: 10px;
    border-radius: 9999px;
    background: radial-gradient(
      circle at 50% 50%,
      rgba(255, 255, 255, 0.9),
      rgba(255, 255, 255, 0) 70%
    );
    animation: cap-bob 3.6s ease-in-out infinite;
    opacity: 0.7;
  }
  @keyframes cap-bob {
    0%,
    100% {
      transform: translateY(0) translateX(0);
      opacity: 0.6;
    }
    50% {
      transform: translateY(-6px) translateX(8px);
      opacity: 0.9;
    }
  }

  .harbor-pier {
    position: absolute;
    left: 4vw;
    right: 4vw;
    bottom: var(--pier-bottom); /* pier baseline */
    height: 22px;
    background: linear-gradient(180deg, #8b5e3c, #6b4226);
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    z-index: 3;
  }

  .harbor-post {
    position: absolute;
    bottom: var(--pier-bottom); /* align with pier baseline */
    width: 10px;
    height: 40px;
    background: linear-gradient(180deg, #795338, #573a25);
    border-radius: 3px;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
    z-index: 2;
  }

  .harbor-boat {
    position: absolute;
    bottom: 20vh;
    font-size: clamp(24px, 6vw, 48px);
    z-index: 2;
  }

  .harbor-buildings {
    position: absolute;
    left: 0;
    right: 0;
    bottom: calc(
      var(--pier-bottom) + var(--pier-height) - 65px
    ); /* 2px overlap over deck */
    height: 24vh;
    pointer-events: none;
    z-index: 1;
  }
  .building-icon {
    position: absolute;
    bottom: 0;
    color: rgba(30, 41, 59, 0.6); /* stroke color for outlines */
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.12));
  }
  .building {
    position: absolute;
    bottom: 0;
    background: linear-gradient(180deg, #dfe7ef, #c9d6e2);
    border: 1px solid rgba(0, 0, 0, 0.06);
    border-radius: 6px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.12);
  }
  .building::before {
    /* roof */
    content: "";
    position: absolute;
    left: -4px;
    right: -4px;
    top: -10px;
    height: 12px;
    border-radius: 4px 4px 0 0;
    background: linear-gradient(180deg, #9aaec3, #7f97ae);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  .building::after {
    /* windows band */
    content: "";
    position: absolute;
    left: 10%;
    right: 10%;
    top: 30%;
    height: 10px;
    border-radius: 2px;
    background: repeating-linear-gradient(
      90deg,
      rgba(70, 90, 120, 0.35) 0 16px,
      rgba(70, 90, 120, 0.12) 16px 26px
    );
    opacity: 0.8;
  }

  /* Per-building subtle color variations */
  .building.b1 {
    background: linear-gradient(180deg, #e7eef6, #d1ddea);
  }
  .building.b2 {
    background: linear-gradient(180deg, #e8f1f8, #cfe0ed);
  }
  .building.b3 {
    background: linear-gradient(180deg, #e9f4f5, #d0e7ea);
  }
  .building.b4 {
    background: linear-gradient(180deg, #eef2f6, #d7e0ea);
  }
  .building.b5 {
    background: linear-gradient(180deg, #f1f4f7, #dbe3ec);
  }
  .building.b6 {
    background: linear-gradient(180deg, #eaf2f9, #d4e1ee);
  }

  .lighthouse {
    position: absolute;
    bottom: 0; /* default baseline for building row */
    width: 28px;
    height: 12vh; /* roughly half the previous height */
    background: linear-gradient(180deg, #ffffff, #e8edf3);
    border: 1px solid rgba(0, 0, 0, 0.06);
    border-radius: 6px;
    box-shadow: 0 6px 14px rgba(0, 0, 0, 0.16);
    z-index: 2;
  }
  /* When placed as standalone on the pier */
  .lighthouse-on-pier {
    bottom: calc(var(--pier-bottom) + var(--pier-height));
  }
  .lighthouse::before {
    /* top cap */
    content: "";
    position: absolute;
    left: -6px;
    right: -6px;
    top: -10px;
    height: 10px;
    border-radius: 6px 6px 0 0;
    background: #a02b2b;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
  }
  .lighthouse::after {
    /* beacon glow */
    content: "";
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 6px;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #ffd966;
    box-shadow: 0 0 12px 6px rgba(255, 217, 102, 0.6),
      0 0 24px 12px rgba(255, 217, 102, 0.25);
    animation: beacon 2.8s ease-in-out infinite;
  }
  @keyframes beacon {
    0%,
    100% {
      opacity: 0.6;
    }
    50% {
      opacity: 1;
    }
  }

  .seagull-layer {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }
  .seagull {
    position: absolute;
    left: -10vw;
    animation-name: gull-fly;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    will-change: transform;
    color: #f5f8fb; /* wing stroke color */
    filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.12))
      drop-shadow(0 3px 6px rgba(0, 0, 0, 0.12));
  }
  .seagull.reverse {
    left: auto;
    right: -10vw;
    animation-name: gull-fly-reverse;
  }
  .gull-svg {
    display: block;
  }
  .gull-wing.left {
    animation: wing-flap 0.9s ease-in-out infinite;
    transform-origin: 32px 16px;
  }
  .gull-wing.right {
    animation: wing-flap 0.9s ease-in-out infinite reverse;
    transform-origin: 32px 16px;
  }
  .gull-wing .tip {
    stroke: #1a1a1a;
    stroke-width: 2.2px;
    stroke-linecap: round;
    /* Only draw the outer 12% of the curve as the black tip */
    stroke-dasharray: 12 88; /* pathLength=100 */
    stroke-dashoffset: 0;
  }
  @keyframes wing-flap {
    0%,
    100% {
      transform: rotate(8deg);
    }
    50% {
      transform: rotate(-12deg);
    }
  }
  @keyframes gull-fly {
    0% {
      transform: translateX(0) translateY(0) rotate(0deg);
    }
    20% {
      transform: translateX(30vw) translateY(-2vh) rotate(2deg);
    }
    40% {
      transform: translateX(60vw) translateY(1vh) rotate(-2deg);
    }
    60% {
      transform: translateX(80vw) translateY(-1.5vh) rotate(1deg);
    }
    100% {
      transform: translateX(110vw) translateY(0) rotate(0deg);
    }
  }
  @keyframes gull-fly-reverse {
    0% {
      transform: translateX(0) translateY(0) rotate(0deg);
    }
    20% {
      transform: translateX(-30vw) translateY(-2vh) rotate(-2deg);
    }
    40% {
      transform: translateX(-60vw) translateY(1vh) rotate(2deg);
    }
    60% {
      transform: translateX(-80vw) translateY(-1.5vh) rotate(-1deg);
    }
    100% {
      transform: translateX(-110vw) translateY(0) rotate(0deg);
    }
  }

  /* Reduced motion for new elements */
  @media (prefers-reduced-motion: reduce) {
    .wave-sway-slow,
    .actor-sway,
    .boat-bob,
    .seagull,
    .wave-cap {
      animation: none !important;
    }
  }
}
